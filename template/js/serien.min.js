var airdateVisible=!1,epListLoadedOnce=!1,epDescLoadedOnce=!0,descLoadedOnce=!0,eplistLoading=!1,epDescLoading=!1,descLoading=!1,epsPositioned=!1,fromNavbar=!1,lastIdShow=-1,lastIdEp=-1,ids="",unsaved=!1;function closeShow(){$("#showDesc").hide(),$("#showEpDesc").hide(),$("#showInfo").hide(),$(".selectedShow").addClass("unselectedShow"),lastIdShow=0}function openNav(e){openNav_(e,!0)}function openNav_(e,o){!(window.innerWidth<980)&&(closeNavs_(e,o),$(e).addClass("open"))}function closeNavs(){closeNavs_(null,!0)}function closeNavs_(e,o){if(window.innerWidth<980)return;let s=[".dropdown-submenu","#dropLatestEps","#dropAdmin","#dropSearch","#dropViewmode"];for(let t=0;t<s.length;t++)if(null==e||""===e||e!==s[t]){if(o&&"#dropLatestEps"===e)continue;if(isAdmin&&"#dropViewmode"===e)continue;$(s[t]).removeClass("open")}}function toggleActive(e){$(e).addClass("active")}function toggleDActive(e){$(e).removeClass("active")}function searchDbForString(e,o){if(null==e)return!1;var s=$.trim(e.value).toLowerCase();if(13!==getKeyCode(o))return!1;var t="./?show=serien&dbSearch=";null!=s&&""!==s&&(t+=s),window.location.href=t}function resetDbSearch(){if(""===$("#searchDBfor").val())return!1;window.location.href="./?show=serien&dbSearch="}function getKeyCode(e){return(e=e||window.event).keyCode}function resizeAll(e){epsPositioned=!1,moveDivR(e),moveDivL(-351),moveDivEpDesc(-351)}function toggleEps(e,o,s){epsPositioned=!1,toggleEps_(e,o,s)}function toggleEps_(e,o,s){var t=null;if(null==s&&null!=e&&(s=e.replace("iD","tgl")),null!=s&&(t=document.getElementById(s)),null!=t){$(".plmin").removeClass("showlink").addClass("hidelink");var n=!1,a=document.getElementsByTagName("TR");if(null!=a)for(var l=0;l<a.length;l++){var d=a[l];if(null!=d&&-1!==d.className.indexOf("epTR")){if(!(d.className.indexOf(e)>-1)){"none"!==d.style.display&&$(d).hide();continue}"none"===d.style.display?($(d).fadeIn(300,"linear"),n=!0):$(d).fadeOut(300,"linear")}}n?($(t).removeClass("hidelink"),$(t).addClass("showlink")):($(t).removeClass("showlink"),$(t).addClass("hidelink")),moveDivR(0),moveDivL(-351),moveDivEpDesc(-351)}}function spoilIt(){$("#epSpoiler").hide(),$("#epDescr").show()}function showActors(){$("#shActor").hide(),$("#shActors").show(),moveDivEpDesc(-$("#showDesc").width())}function episodeActors(){$("#epActor").hide(),$("#epActors").show()}function setFlagsBack(e){"#showInfo"===e?eplistLoading=!1:"#showDesc"===e?descLoading=!1:"#showEpDesc"===e&&(epDescLoading=!1)}function checkShowInfo(e,o){var s=0;do{if($(e).width()>0){cursorBusy(""),resizeAll(o),setFlagsBack(e);return}if(s++>100)return}while(0===$(e).width());setFlagsBack(e)}function cursorBusy(e){$("body").css("cursor",e),$("#xbmcDB").css("cursor",e),$("#showInfo").css("cursor",e),$("td").css("cursor",e),$("a").css("cursor",""===e?"pointer":e),$("a.nopo, a.fancy_msgbox, a.fancy_addEpisode, li.dropdown-submenu>a").css("cursor",""===e?"default":e)}function loadLatestShowInfo(e,o,s,t,n){fromNavbar=!0,$("#showInfo").hide(),loadShowInfoPlus(e,o,t,n),loadEpDetails(e,s),toggleEps_(t,n,null),epsPositioned=!1,moveDivR(3),$("#showInfo").show(),closeNavs()}function loadShowInfo(e,o){loadShowInfoPlus(e,o,null,null),moveDivR(-1)}function loadShowInfoPlus(e,o,s,t){if(!epDescLoading&&lastIdShow!==o)return cursorBusy("progress"),$("#showEpDesc").text(""),moveDivEpDesc(0),$(".sTR").children("TD").removeClass("selectedShow unselectedShow"),$("#iD"+o).children("TD").addClass("selectedShow"),loadEplistPlus(e,s,t),loadDesc(e,o),lastIdShow=o,lastIdEp=-1,!0}function loadEpDetails(e,o){epsPositioned=!1,!epDescLoading&&lastIdEp!==o&&($(".epTR").children("TD").removeClass("selectedShow"),$("#"+o).children("TD").addClass("selectedShow"),epDescLoadedOnce?$("#showEpDesc").fadeOut(100,"linear",function(){loadEpDetails_(e,o)}):loadEpDetails_(e,o),epDescLoadedOnce=!0)}function loadEpDetails_(e,o){return epDescLoading=!0,cursorBusy("progress"),$("#showEpDesc").text(""),$("#showEpDesc").show(),moveDivEpDesc(0),$("#showEpDesc").load($(e).attr("_href"),function(){$("#showEpDesc").animate({width:"+=351px",left:"-=352px",height:"+=400px"},"slow",function(){var e=$("#epDescription").height()+"px";checkShowInfo("#showEpDesc",1),$("#showEpDesc").css({width:"351px",height:e}),$("#"+o).children("TD").addClass("selectedShow")})}),lastIdEp=o,epsPositioned=!0,!1}function moveDivEpDesc(e){var o=lastIdShow<0?"#showsDiv":".selectedShow";if($(o).length){var s=$.browser.webkit?3:0,t=$(o).position().left,n=$("#showDesc").position().top+$(".showDesc").height()+1;$("#showDesc").width(),$("#showEpDesc").css({position:"absolute",top:n+"px",left:Math.floor(t+e+s)+"px",width:"0px",height:"auto","z-index":"2"}),epDescLoading||($("#showEpDesc").css({width:"351px"}),$("#epDescription").css({width:$.browser.webkit?"350px":"352px"}))}}function loadEplist(e){loadEplistPlus(e,null,null)}function loadEplistPlus(e,o,s){if(epsPositioned=!1,eplistLoading)return!1;epListLoadedOnce?$("#showInfo").fadeOut(200,"linear",function(){loadEplistPlus_(e,o,s)}):loadEplistPlus_(e,o,s),epListLoadedOnce=!0}function loadEplist_(e){loadEplistPlus_(e,null,null)}function loadEplistPlus_(e,o,s){eplistLoading=!0,$("#showInfo").text(""),$("#showInfo").show(),moveDivR(0),$("#showInfo").load($(e).attr("eplist"),function(){$("#showInfo").animate({width:"+=385px"},"slow",function(){if(checkShowInfo("#showInfo",0),$("#showInfo").css({width:"385px",height:"auto"}),$.browser.mozilla&&$("#showInfo").css({left:"+=1px"}),toggleEps(o,s,null),initShowEpFancies(),fromNavbar){var e=$(".selectedShow").offset().top-50;$("html, body").animate({scrollTop:e},250),fromNavbar=!1}})})}function loadDesc(e,o){if(descLoading)return!1;descLoadedOnce?$("#showDesc").fadeOut(200,"linear",function(){loadDesc_(e,o)}):loadDesc_(e,o),descLoadedOnce=!0}function loadDesc_(e,o){var s=lastIdShow<0?"#showsDiv":".selectedShow";if($(s).length){var t=$.browser.webkit?0:-1,n=$.browser.webkit?3:1;descLoading=!0,$("#showDesc").text(""),$("#showDesc").show(),moveDivL(0);var a=$(s).position().top+t+"px",l=Math.floor($(s).position().left+0+n-352)+"px";$("#showDesc").load($(e).attr("desc"),function(){$("#showDesc").animate({width:"+=351px",left:l,top:a},"slow",function(){checkShowInfo("#showDesc",0),$("#showDesc").css({width:"351px",left:l}),$(".fClose").show(),initShowDescFancies(),drawDonut(o)})})}}function moveDivL(e){var o=lastIdShow<0?"#showsDiv":".selectedShow";if($(o).length){var s=$.browser.webkit?0:-1,t=$.browser.webkit?2:.5,n=$(o).position().left,a=$(o).position().top+s;$("tbody:first").width(),$("#showDesc").css({position:"absolute",top:a+"px",left:Math.floor(n+e+t)+"px",width:"0px",height:"auto","z-index":"2"}),descLoading||$("#showDesc").css({width:"351px"})}}function moveDivR(e){if(!epsPositioned){var o=lastIdShow<0?"#emptyTR":".selectedShow";if($(o).length){var s=$.browser.webkit?0:-1,t=$.browser.webkit?1:-.5,n=$(o).position().left,a=$(o).position().top+s,l=$("tbody:first").width();$("#showInfo").css({position:"absolute",top:a+"px",left:Math.floor(n+l+t+e)+"px",width:"0px",height:"auto","z-index":"2"}),eplistLoading||$("#showInfo").css({width:"385px"})}}}function toggleAirdates(){if(isAdmin){var e=$("#showsTable").width();airdateVisible?($(".showName").removeClass("airdShown").addClass("airdHidden"),$(".airdate").hide(),e-=75):($(".showName").removeClass("airdHidden").addClass("airdShown"),$(".airdate").show(),e+=75),airdateVisible=!airdateVisible,$("#showsTable").css({width:e+"px"}).css({"min-width":e+"px"}),resizeAll(0)}}function checkForCheck(){return!unsaved||null==ids||""==ids||confirm("Attention:\nSelection will be lost!")}function clearSelectBoxes(e){var o=document.getElementsByTagName("input"),s=null!=e&&e.checked;for(null==e&&$("#clearSelectAll").attr("checked",!1),i=0;i<o.length;i++){var t=o[i];null!=t&&"copyAsScript"!==t.id&&"clearSelectAll"!==t.id&&("checkbox"!==t.type||t.checked===s||t.disabled||(t.checked=s,selected(t,!1,!1,isAdmin)))}var n=document.getElementById("result"),a=document.getElementById("movieList");null!=a&&(doRequest(),a.style.display=s?"block":"none",s||(n.innerHTML="",ids=""))}function doRequest(){doRequest__(!0,ids)}function saveSelection(){saveSelection__(!0,ids)}function drawDonut(e){if(null!=e&&!(e<0)){var o=null;if($("#donutChartPie").length)o=$("#donutChartPie").get(0).getContext("2d");else{console.log("Error: Canvas not found with selector #donutChartPie");return}ajax_chart(new Chart(o,{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:[]}]},options:{cutout:"40%",borderWidth:0,plugins:{legend:{display:!1},tooltip:{enabled:!1}}}}),"./detailSerieDesc.php?data&id="+e)}}function ajax_chart(e,o,s){var s=s||{};$.getJSON(o,s).done(function(o){e.data.labels=o.labels,e.data.datasets[0].backgroundColor=o.datasets[0].backgroundColor,e.data.datasets[0].data=o.datasets[0].data,e.update()})}function setAspectRatio(e,o,s=""){if(null===e||null===o)return;let t=prompt("Enter aspect ratio",s);if(null!==t){""===t.trim()?s="":t=t.replace(",","."),null===t||""===t||isNaN(t)||(s=Number.parseFloat(t));var n="./dbEdit.php?act=setAspectRatio&noForward=1&idFile="+e+"&idMovie="+o+"&aRatio="+s;$.ajax(n)}}function setToneMapParam(e,o=""){if(null===e)return;let s=prompt("Enter ToneMap Param",o);if(null!==s){""===s.trim()?o="":s=s.replace(",","."),""===s||isNaN(o)||(o=Number.parseFloat(o));var t="./dbEdit.php?act=setToneMapParam&noForward=1&idFile="+e+"&tomParam="+o;$.ajax(t)}}$(document).ready(function(){$(".dropdown-toggle").dropdown(),$(document).keydown(function(e){bindF&&e.ctrlKey&&"70"==e.keyCode&&(e.preventDefault(),openNav("#dropSearch"),$("#searchDBfor").focus()),!isAdmin&&e.ctrlKey&&"83"==e.keyCode&&(e.preventDefault(),saveSelection())})}),$(window).resize(function(){resizeAll(0)}),$("#showsTable").ready(function(){resizeAll(0)});